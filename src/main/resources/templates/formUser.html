<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="th_templates/head :: head"></head>

<body>
  <!-- NAVBAR >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <header th:replace="th_templates/navbar :: navbar"></header>

  <main class="main-form1">

    <!-- IMG OF THE HANDYMAN >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
    <div class="container text-center">
      <div class="row">
        <div class="col mx-auto">
          <img class="image2" src="../img/homeRepair.svg" alt="home repair">
          <h1 class="big-title">游닇 춰Registrate!</h1>
          <h4 class="subtitle">Pero antes contanos...</h4>
        </div>
      </div>
    </div>

    <!-- eric: cambio el form aqui ya que sino no toma los roles-->
    <form id="formContainer" class="form-container2" th:object="${user}" th:action="@{/user/register}" method="post"
      enctype="multipart/form-data">

      <section class="cardContainer">

        <div class="row justify-content-center" th:field="*{role}">
          <div class="col-md-6">
            <div class="card">
              <img src="/img/customer-avatar.png" class="card-img-top" alt="avatar">
              <div class="card-body">
                <label for="customer">
                  <h5 class="card-title">쯉os cliente?</h5>
                  <p class="card-text">Selecciona esta opci칩n si necesit치s adquirir un servicio.</p>
                  <input id="customer" type="radio" th:value="${customerRole}" name="role">
                </label>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card">
              <img src="/img/provider-avatar.png" class="card-img-top" alt="avatar">
              <div class="card-body">
                <label for="provider">
                  <h5 class="card-title">쯉os profesional?</h5>
                  <p class="card-text">Selecciona esta opci칩n si quer칠s prestar un servicio.</p>
                  <input id="provider" type="radio" th:value="${providerRole}" name="role">
                </label>
              </div>
            </div>
          </div>
        </div>
</section>
      <!--    eric: aqui antes empezaba el <form>-->

      <div id="user-info" style="display: none;">
        <label class="label" for="nombre"></label>
        <input type="text" id="nombre" name="nombre" placeholder="Tu nombre" th:field="*{name}" required />

        <label class="label" for="lastname"></label>
        <input type="text" id="lastname" name="lastname" placeholder="Tu apellido" th:field="*{lastname}" required />

        <label class="label" for="email"></label>
        <input type="text" id="email" name="email" placeholder="email@email.com" th:field="*{email}" required />

        <label class="label" for="password"></label>
        <input type="password" id="password" name="password" placeholder="Contrase침a" th:field="*{password}" required />

        <label class="label" for="password2"></label>
        <input type="password" id="password2" name="password2" placeholder="Repet칤 tu contrase침a" required />


        <!-- <label for="img" class="btn btn-warning button">
          游닞 Subir foto de perfil
          <input type="file" id="img" name="img" accept=".png, .jpeg, .jpg" capture="user" style="display:none;" />
        </label> -->

        <!--eric: para que no de error ya saque las cosas de user, dejo comentado para la reutilizacion en user.html-->
        <!--        <div  style="display:none;">-->
        <!--          <label for="img" class="btn btn-warning button">-->
        <!-- 游닞 Subir foto de perfil -->
        <!--            <input type="file" id="img" name="img" accept=".png, .jpeg, .jpg" capture="user" />-->
        <!--          </label>-->
        <!--        </div>-->
      </div>

      <div id="user-info-provider" style="display: none;">
        <!-- Aqu칤 va el formulario o informaci칩n adicional para proveedores -->

        <br>
        <select id="profession" class="inputs" th:field="*{profession}">
          <option value="" selected>Eleg칤 tu profesi칩n</option>
          <option th:each="professions : ${professions}" th:text="${professions.name}" th:value="${professions}"
            required />
        </select>

        <label class="label" for="description"></label>
        <textarea classs="description" maxlength="500" id="description" name="description"
          placeholder="Describ칤 tu actividad" th:field="*{description}"></textarea>
      </div>

      <br>

      <div class="submit-btn-container">
        <button id="submit-btn" type="submit" class="btn btn-warning button">游닇 춰Registrate!</button>
      </div>

    </form>
  </main>

  <!-- FOOTER >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <footer th:replace="th_templates/footer :: footer"></footer>

  <!-- Script / Bootstrap -->
  <div th:replace="th_templates/bootstrap :: bootstrap"></div>


  <!-- SCRIPT FOR CARDS & BUTTON by @Fede >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <script>
    // Obtener los elementos del formulario y el bot칩n de registro
    const userInfoDiv = document.getElementById("user-info");
    const userInfoProviderDiv = document.getElementById("user-info-provider");
    const submitBtn = document.getElementById("submit-btn");

    // Ocultar el bot칩n de registro por defecto
    submitBtn.style.display = "none";

    // Agregar un evento de escucha de cambio a los elementos del formulario
    userInfoDiv.addEventListener("change", checkForms);
    userInfoProviderDiv.addEventListener("change", checkForms);

    // Obtener las tarjetas de usuario
    const userCards = document.querySelectorAll(".card");

    // Agregar un evento de escucha de clic a cada tarjeta
    userCards.forEach((card) => {
      card.addEventListener("click", function () {
        // Obtener el t칤tulo de la tarjeta
        const title = card.querySelector(".card-title").textContent;

        // Mostrar el formulario de informaci칩n del usuario
        userInfoDiv.style.display = "block";

        // Mostrar u ocultar el formulario de informaci칩n del proveedor seg칰n el t칤tulo de la tarjeta
        if (title === "쯉os profesional?") {
          userInfoProviderDiv.style.display = "block";
        } else {
          userInfoProviderDiv.style.display = "none";
        }

        // Verificar si alguno de los formularios est치 visible
        checkForms();
      });
    });

    function checkForms() {
      // Verificar si alguno de los formularios est치 visible
      if (userInfoDiv.style.display !== "none" || userInfoProviderDiv.style.display !== "none") {
        // Mostrar el bot칩n de registro si alguno de los formularios est치 visible
        submitBtn.style.display = "block";
      } else {
        // Ocultar el bot칩n de registro si ninguno de los formularios est치 visible
        submitBtn.style.display = "none";
      }
    }
  </script>

  <!-- SCRIPT TO LOWERCASE by @Fede >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <script>
    let select = document.querySelector('#profession');
    for (let i = 0; i < select.options.length; i++) {
      let optionText = select.options[i].text;
      select.options[i].text = optionText.charAt(0).toUpperCase() + optionText.slice(1).toLowerCase();
    }
  </script>

</body>

</html>