<!DOCTYPE html>
<!-- html xmlns:th="http://www.thymeleaf.org" = Para evitar que HTML arroje errores por trabajar con elementos de thymeleaf -->
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="th_templates/head :: head"></head>

<body>
  <!-- NAVBAR >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <header th:replace="th_templates/navbar :: navbar"></header>

  <main class="main-index">

    <!-- IMG OF THE HANDYMAN >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
    <div class="container text-center">
      <div class="row">
        <div class="col left-col">
          <h4 class="subtitle">Te damos la bienvenida</h4>
          <h1 class="big-title">Administrador!</h1>
        </div>
        <div class="col">
          <img class="image2" src="../img/database.svg" alt="database">
        </div>
      </div>
    </div>

    <!-- FORM SEARCH >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->

    <form method="post" id="search-form" action="/admin/search">
      <div class="row">
        <div class="col">
          <h4>Busqueda: </h4>
        </div>
        <div class="col">
          <input oninput="validateInput()" type="text" name="search" id="search"
            placeholder="nombre, apellido, email, profesiÃ³n">
        </div>
        <div id="search-button" class="col"><button type="submit" class="btn btn-warning button" disabled>ðŸ”Ž
            BUSCAR</button>
        </div>
      </div>
    </form>

    <!-- TABLE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
    <table class="table table-dark table-striped" id="table-se">
      <thead>
        <tr>
          <th colspan="9">
            <h4>Resultado de bÃºsqueda</h4>
          </th>
        </tr>
        <tr>
          <th>Foto</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Email</th>
          <th>ProfesiÃ³n</th>
          <th>Rol</th>
          <th colspan="3">Acciones</th>
        </tr>
      </thead>
      <tbody th:each="se : ${se}">
        <tr>
          <td><img class="profilePic img-fluid rounded" th:src="@{'/image/DB/' + ${se.image}}"></td>
          <td th:text="${se.name}"></td>
          <td th:text="${se.lastname}"></td>
          <td th:text="${se.email}"></td>
          <td th:text="${se.profession}"></td>
          <td th:text="${se.role}" class="td-role"></td>
          <td><a th:href="@{/user/perfil/__${se.id}__}"><i class="bi bi-person-circle"></i> Cambiar Rol</a></td>
          <td><a th:href="@{/user/perfil/__${se.id}__}"><i class="bi bi-pen"></i> Modificar</a></td>
          <td><a th:href="@{/user/perfil/__${se.id}__}"><i class="bi bi-trash"></i> Eliminar</a></td>
        </tr>
      </tbody>
    </table>
    <table class="table table-dark table-striped" id="table" style="display: none">
      <thead>
        <tr>
          <th colspan="9">
            <h4>Todos los registros</h4>
          </th>
        </tr>
        <tr>
          <th>Foto</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Email</th>
          <th>ProfesiÃ³n</th>
          <th>Rol</th>
          <th colspan="3">Acciones</th>
        </tr>
      </thead>
      <tbody th:each="u : ${users}">
        <tr>
          <td><img class="profilePic img-fluid rounded" th:src="@{'/image/DB/' + ${u.image}}"></td>
          <td th:text="${u.name}"></td>
          <td th:text="${u.lastname}"></td>
          <td th:text="${u.email}"></td>
          <td th:text="${u.profession}"></td>
          <td th:text="${u.role}" class="td-role"></td>
          <form method="POST" th:action="@{/user/perfil/__${u.id}__/role}">
            <td>
              <button type="submit"><i class="bi bi-person-circle"></i> Cambiar Rol</button>
            </td>
          </form>
          <td><a th:href="@{/user/perfil/__${u.id}__}"><i class="bi bi-pen"></i> Modificar</a></td>
          <td><a th:href="@{/user/perfil/__${u.id}__}"><i class="bi bi-trash"></i> Eliminar</a></td>
        </tr>
      </tbody>
    </table>
  </main>

  <br><br><br>

  <!-- SCRIPTS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <!----------- Script for show Tables ----------->
  <script>

    function toggleTable() {
      var table = document.getElementById("table");
      if (table.style.display === "none") {
        table.style.display = "table";
      } else {
        table.style.display = "none";
      }
    }

  </script>

  <!----------- Script for hidde Search Engine ----------->
  <script>
    var table = document.getElementById("table-se");
    var rows = table.getElementsByTagName("tr");

    if (rows.length == 2) {
      table.style.display = "none";
    }
  </script>

  <!----------- Script for block input ----------->
  <script>
    function validateInput() {
      var searchValue = document.getElementById("search").value;
      if (searchValue.trim().length > 0) {
        document.getElementById("search-button").querySelector("button").disabled = false;
      } else {
        document.getElementById("search-button").querySelector("button").disabled = true;
      }
    }
  </script>

  <!-- FOOTER >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  -->
  <footer th:replace="th_templates/footer :: footer"></footer>

  <!-- Script / Bootstrap -->
  <div th:replace="th_templates/bootstrap :: bootstrap"></div>

</body>

</html>
